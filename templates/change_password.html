{% extends "layout/base.html" %}
{% block title %}Change Password{% endblock %}

{% block content %}
<div class="container" style="max-width: 600px;">
  <div class="card glass-card p-4">
    <h3 class="gradient-text mb-4">
      {% if must_change_password %}<i class="fas fa-key"></i> Set Password
      {% else %}<i class="fas fa-key"></i> Change Password{% endif %}
    </h3>

    {% if must_change_password %}
      <div class="alert alert-warning">⚠️ You must change your temporary password.</div>
    {% endif %}

    <form method="POST" onsubmit="return validateForm()">
      <div class="mb-3">
        <label class="form-label">
          {% if must_change_password %}Temporary Password *{% else %}Old Password *{% endif %}
        </label>
        <input type="password" name="old_password" class="form-control" required>
        {% if must_change_password %}
          <small class="text-muted">Use the password from admin</small>
        {% endif %}
      </div>

      <div class="mb-3">
        <label class="form-label">New Password *</label>
        <input type="password" name="new_password" class="form-control" required minlength="6">
      </div>

      <div class="mb-3">
        <label class="form-label">Confirm New Password *</label>
        <input type="password" name="confirm_password" class="form-control" required minlength="6">
      </div>

      <button type="submit" class="btn btn-primary w-100">
        {% if must_change_password %}Set My Password{% else %}Change Password{% endif %}
      </button>
    </form>
  </div>
</div>

<script>
function validateForm() {
  const newPass = document.querySelector('[name="new_password"]').value;
  const confirmPass = document.querySelector('[name="confirm_password"]').value;
  
  if (newPass !== confirmPass) {
    alert('❌ Passwords do not match!');
    return false;
  }
  if (newPass.length < 6) {
    alert('❌ Password must be at least 6 characters!');
    return false;
  }
  return true;
}
</script>
{% endblock %}